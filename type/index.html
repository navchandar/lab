<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Type Text</title>

    <link
      rel="icon"
      href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCI+PHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjMjIyIi8+PHJlY3QgeD0iMjgiIHk9IjEyIiB3aWR0aD0iOCIgaGVpZ2h0PSI0MCIgZmlsbD0iIzBmMCIvPjwvc3ZnPg=="
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lexend:wght@700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg-color: #ffffff;
        --text-color: #121212;
        --caret-color: #121212;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --bg-color: #121212;
          --text-color: #e0e0e0;
          --caret-color: #e0e0e0;
        }
      }

      body,
      html {
        display: flex;
        justify-content: center;
        align-items: center;
        /* Ensure taps anywhere focus the input */
        cursor: text;
        margin: 0;
        background-color: var(--bg-color);
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      /* Font Stack: Lexend first, Comic Sans as reliable backup */
      #big-input {
        /* Prepare for animation */
        transform-origin: center;
        will-change: transform;
        outline: none;
        border: none;
        background: transparent;
        width: 100%;
        height: 100%;
        color: var(--text-color);
        caret-color: var(--caret-color);
        font-weight: 700;
        font-size: 40vh;
        font-family:
          "Lexend", "Comic Sans MS", "Chalkboard SE", "Comic Neue", sans-serif;
        text-align: center;
        text-transform: uppercase;
      }

      #big-input.hide-caret {
        caret-color: transparent;
        text-shadow: 0 0 0 var(--text-color);
      }

      /* The "Juice" Animation */
      @keyframes popIn {
        0% {
          transform: scale(0.5);
          opacity: 0;
        }
        50% {
          transform: scale(1.2);
          opacity: 1;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      /* Class we will toggle via JS to trigger animation */
      .animate-pop {
        animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
    </style>
  </head>
  <body>
    <input
      type="text"
      id="big-input"
      autocomplete="off"
      spellcheck="false"
      inputmode="text"
      autofocus
    />

    <script>
      const input = document.getElementById("big-input");

      // --- Focus Logic ---
      const forceFocus = () => {
        // Check if element is already focused to avoid loop firing
        if (document.activeElement !== input) {
          input.focus();
        }
      };

      // Focus immediately
      forceFocus();

      // Re-focus whenever focus is lost
      input.addEventListener("blur", () => {
        // Small timeout allows browser UI interaction (like clicking address bar)
        // if absolutely necessary, but pulls focus back quickly.
        setTimeout(forceFocus, 10);
      });

      // Focus if user clicks anywhere on the background
      document.addEventListener("click", forceFocus);

      // --- Input & Animation Logic ---
      input.addEventListener("input", (e) => {
        let val = input.value;

        // 1. Logic: Take last character only
        if (val.length > 1) {
          val = val.slice(-1);
        }

        // 2. Validation: Letters/Numbers only
        val = val.replace(/[^a-zA-Z0-9]/g, "");
        input.value = val;

        // 3. Toggle Caret & Trigger Animation
        if (val.length > 0) {
          input.classList.add("hide-caret");

          // TRIGGER ANIMATION "REFLOW"
          // We remove the class, force the browser to calculate layout, then re-add it.
          input.classList.remove("animate-pop");
          void input.offsetWidth; // forces the reflow
          input.classList.add("animate-pop");
        } else {
          input.classList.remove("hide-caret");
          input.classList.remove("animate-pop");
        }
      });

      // Prevent cursor movement with arrow keys
      // Handle arrow keys
      input.addEventListener("keydown", (e) => {
        if (
          ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].indexOf(e.code) >
          -1
        ) {
          e.preventDefault();
        }
      });
    </script>
  </body>
</html>
